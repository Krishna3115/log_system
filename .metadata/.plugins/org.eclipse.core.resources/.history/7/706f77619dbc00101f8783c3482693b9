package com.call_logs.system.entity;

import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.LocalTime;
import java.util.ArrayList;
import java.util.List;

import com.call_logs.system.enums.Status;
import com.fasterxml.jackson.annotation.JsonBackReference;
import com.fasterxml.jackson.annotation.JsonManagedReference;

import jakarta.persistence.CascadeType;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.EnumType;
import jakarta.persistence.Enumerated;
import jakarta.persistence.FetchType;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.JoinColumn;
import jakarta.persistence.ManyToOne;
import jakarta.persistence.OneToMany;
import jakarta.persistence.Table;


@Entity
@Table(name = "call_logs")
public class CallLog {

	 @Id
	    @GeneratedValue(strategy = GenerationType.IDENTITY)
	    private Long id;

	    private String customerName;
	    private String mobileNumber;
	    private String address; // Added if not already
	    private LocalDateTime dateTime;
	    private String systemType;
	    @Column(name = "description", columnDefinition = "TEXT")
	    private String description;


	    @ManyToOne
	    @JoinColumn(name = "received_by")
	    private User receivedBy;

	    @ManyToOne
	    @JoinColumn(name = "assigned_employee")
	    private User assignedEmployee;

	    @Enumerated(EnumType.STRING)
	    private Status status;

	    private String remarks; // Optional field
	    
	    @Column(name = "system_number")
	    private String systemNumber;

	    @Column(name = "received_accessories")
	    private String receivedAccessories;

	    @Column(name = "delivery_date")
	    private LocalDate deliveryDate;

	    @Column(name = "delivery_time")
	    private LocalTime deliveryTime;
	    
		@OneToMany(mappedBy = "callLog", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
		private List<CallLogQuery> queries = new ArrayList<>();
		
		@OneToMany(mappedBy = "callLog", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
		@JsonManagedReference
		private List<Part> parts;

		@ManyToOne
		@JoinColumn(name = "call_log_id")
		@JsonBackReference
		private CallLog callLog;

		
		@Column(name = "work_description", columnDefinition = "TEXT")
	    private String workDescription; // description of work done

	    @Column(name = "total_bill_amount")
	    private Double totalBillAmount; // total bill amount for the job

	    @Column(name = "customer_email")
	    private String customerEmail; // email to send bill
	    
		
	    public CallLog() {
		// TODO Auto-generated constructor stub
	}


		public CallLog(Long id, String customerName, String mobileNumber, String address, LocalDateTime dateTime,
				String systemType, String description, User receivedBy, User assignedEmployee, Status status,
				String remarks, String systemNumber, String receivedAccessories, LocalDate deliveryDate,
				LocalTime deliveryTime, List<CallLogQuery> queries, List<Part> parts, String workDescription,
				Double totalBillAmount, String customerEmail) {
			super();
			this.id = id;
			this.customerName = customerName;
			this.mobileNumber = mobileNumber;
			this.address = address;
			this.dateTime = dateTime;
			this.systemType = systemType;
			this.description = description;
			this.receivedBy = receivedBy;
			this.assignedEmployee = assignedEmployee;
			this.status = status;
			this.remarks = remarks;
			this.systemNumber = systemNumber;
			this.receivedAccessories = receivedAccessories;
			this.deliveryDate = deliveryDate;
			this.deliveryTime = deliveryTime;
			this.queries = queries;
			this.parts = parts;
			this.workDescription = workDescription;
			this.totalBillAmount = totalBillAmount;
			this.customerEmail = customerEmail;
		}


		public Long getId() {
			return id;
		}


		public void setId(Long id) {
			this.id = id;
		}


		public String getCustomerName() {
			return customerName;
		}


		public void setCustomerName(String customerName) {
			this.customerName = customerName;
		}


		public String getMobileNumber() {
			return mobileNumber;
		}


		public void setMobileNumber(String mobileNumber) {
			this.mobileNumber = mobileNumber;
		}


		public String getAddress() {
			return address;
		}


		public void setAddress(String address) {
			this.address = address;
		}


		public LocalDateTime getDateTime() {
			return dateTime;
		}


		public void setDateTime(LocalDateTime dateTime) {
			this.dateTime = dateTime;
		}


		public String getSystemType() {
			return systemType;
		}


		public void setSystemType(String systemType) {
			this.systemType = systemType;
		}


		public String getDescription() {
			return description;
		}


		public void setDescription(String description) {
			this.description = description;
		}


		public User getReceivedBy() {
			return receivedBy;
		}


		public void setReceivedBy(User receivedBy) {
			this.receivedBy = receivedBy;
		}


		public User getAssignedEmployee() {
			return assignedEmployee;
		}


		public void setAssignedEmployee(User assignedEmployee) {
			this.assignedEmployee = assignedEmployee;
		}


		public Status getStatus() {
			return status;
		}


		public void setStatus(Status status) {
			this.status = status;
		}


		public String getRemarks() {
			return remarks;
		}


		public void setRemarks(String remarks) {
			this.remarks = remarks;
		}


		public String getSystemNumber() {
			return systemNumber;
		}


		public void setSystemNumber(String systemNumber) {
			this.systemNumber = systemNumber;
		}


		public String getReceivedAccessories() {
			return receivedAccessories;
		}


		public void setReceivedAccessories(String receivedAccessories) {
			this.receivedAccessories = receivedAccessories;
		}


		public LocalDate getDeliveryDate() {
			return deliveryDate;
		}


		public void setDeliveryDate(LocalDate deliveryDate) {
			this.deliveryDate = deliveryDate;
		}


		public LocalTime getDeliveryTime() {
			return deliveryTime;
		}


		public void setDeliveryTime(LocalTime deliveryTime) {
			this.deliveryTime = deliveryTime;
		}


		public List<CallLogQuery> getQueries() {
			return queries;
		}


		public void setQueries(List<CallLogQuery> queries) {
			this.queries = queries;
		}


		public List<Part> getParts() {
			return parts;
		}


		public void setParts(List<Part> parts) {
			this.parts = parts;
		}


		public String getWorkDescription() {
			return workDescription;
		}


		public void setWorkDescription(String workDescription) {
			this.workDescription = workDescription;
		}


		public Double getTotalBillAmount() {
			return totalBillAmount;
		}


		public void setTotalBillAmount(Double totalBillAmount) {
			this.totalBillAmount = totalBillAmount;
		}


		public String getCustomerEmail() {
			return customerEmail;
		}


		public void setCustomerEmail(String customerEmail) {
			this.customerEmail = customerEmail;
		}
		
}
